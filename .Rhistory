g
g <- ggplot(data = topDrivers, aes(x = E2, y = Total_cost), stat = "identity") + geom_line()
g
g <- ggplot(data = topDrivers, aes(x = E2, y = Total_cost), stat = "identity") + geom_point()
g
ggplot(data = topDrivers, aes(x = E2, y = Total_cost)) + geom_point()
ggplot(data = topDrivers, aes(x = E2, y = Total_cost)) + geom_point()
ggplot(data = topDrivers, aes(x = E2, y = Total_cost)) + geom_bar()
ggplot(data = topDrivers) + geom_bar(aes(x = E2, y = Total_cost))
ggplot(data = topDrivers) + geom_bar(aes(x = E2, y = Total_cost), stat = "identity")
ggplot(data = topDrivers) + geom_bar(aes(x = E2, y = Total_cost), stat = "identity")
ggplot(data = topDrivers) + geom_bar(aes(x = E2, y = Total_cost), stat = "identity", reorder(E2, -Total_cost))
ggplot(data = topDrivers, reorder(E2, -Total_cost)) + geom_bar(aes(x = E2, y = Total_cost), stat = "identity")
ggplot(data = topDrivers) + geom_bar(aes(x = reorder(E2, -Total_cost), y = Total_cost), stat = "identity")
ggplot(data = topDrivers) + geom_bar(aes(x = reorder(E2, -Qty), y = Qty), stat = "identity")
ggplot(data = topDrivers) + geom_bar(aes(x = E2, y = Qty), stat = "identity")
ggplot(data = topDrivers) + geom_bar(aes(x = reorder(E2, -Qty), y = Qty), stat = "identity")
geom_text(aes(label=Qty))
ggplot(data = topDrivers) + geom_bar(aes(x = reorder(E2, -Qty), y = Qty), stat = "identity") +geom_text(aes(label=Qty))
ggplot(data = topDrivers,aes(x = reorder(E2, -Qty), y = Qty) + geom_bar(), stat = "identity") + geom_text(aes(label=Qty))
ggplot(data = topDrivers, aes(x = reorder(E2, -Qty), y = Qty)) + geom_bar(stat = "identity")
ggplot(data = topDrivers, aes(x = reorder(E2, -Qty), y = Qty)) + geom_bar(stat = "identity") + geom_text()
ggplot(data = topDrivers, aes(x = reorder(E2, -Qty), y = Qty)) + geom_bar(stat = "identity") + geom_text(aes(y = Qty))
ggplot(data = topDrivers, aes(x = reorder(E2, -Qty), y = Qty)) + geom_bar(position = 'dodge', stat = "identity") + geom_text(aes(y = Qty))
ggplot(data = topDrivers, aes(x = reorder(E2, -Qty), y = Qty)) + geom_bar(stat = "identity")
ggplot(data = topDrivers, aes(x = reorder(E2, -Qty), y = Qty)) + geom_col()
ggplot(data = topDrivers, aes(x = reorder(E2, -Qty), y = Qty)) + geom_col() + geom_text(aes(y = Qty))
ggplot(data = topDrivers, aes(x = reorder(E2, -Qty), y = Qty)) + geom_col() + geom_text(aes(x = E2, y = Qty))
ggplot(data = topDrivers, aes(x = reorder(E2, -Qty), y = Qty)) + geom_col() + geom_text(aes(label = Qty))
ggplot(data = topDrivers, aes(x = reorder(E2, -Qty), y = Qty)) + geom_col() + geom_text(aes(label = Qty, vjust = 0.2))
ggplot(data = topDrivers, aes(x = reorder(E2, -Qty), y = Qty)) + geom_col() + geom_text(aes(label = Qty, vjust = 0.4))
ggplot(data = topDrivers, aes(x = reorder(E2, -Qty), y = Qty)) + geom_col() + geom_text(aes(label = Qty, vjust = 1.0))
ggplot(data = topDrivers, aes(x = reorder(E2, -Qty), y = Qty)) + geom_col() + geom_text(aes(label = Qty, vjust = -1.0))
ggplot(data = topDrivers, aes(x = reorder(E2, -Qty), y = Qty)) + geom_col() + geom_text(aes(label = Qty, vjust = -0.5))
ggplot(data = topDrivers, aes(x = reorder(E2, -Qty), y = Qty)) + geom_col(color = E2) + geom_text(aes(label = Qty, vjust = -0.5))
ggplot(data = topDrivers, aes(x = reorder(E2, -Qty), y = Qty, fill = E2)) + geom_col(color = E2) + geom_text(aes(label = Qty, vjust = -0.5))
ggplot(data = topDrivers) + geom_col(aes(x = reorder(E2, -Qty), y = Qty, fill = E2)) + geom_text(aes(label = Qty, vjust = -0.5))
monthlyDrivers <- filter(YTD_drivers, Month == "August")
View(monthlyDrivers)
driverIDs <- data.frame(do.call("rbind", strsplit(as.character(monthlyDrivers$Item_ID), "-", fixed = TRUE)))
View(driverIDs)
View(driverIDs)
View(driverIDs)
View(driverIDs)
rm(driverIDs)
driverIDs <- data.frame(do.call("rbind", strsplit(as.character(monthlyDrivers$Item_ID), "-", fixed = TRUE)))
View(driverIDs)
driversFinal <- cbind(monthlyDrivers, driverIDs) %>%
select(c("RMA_ID", "Item_ID", "Item_Name", "Return_Qty", "Reason_Code", "X4"))
View(driversFinal)
names(driversFinal) <- c("RMA_ID", "Item_ID", "Item_Name", "Return_Qty", "Reason_Code", "DIM_Type")
driversFinal1 <- driversFinal %>%
left_join(driver_to_E2, by = c("Item_ID", "SP_Kit"))
View(driver_to_E2)
driversFinal1 <- driversFinal %>%
left_join(driver_to_E2, by = c("Item_ID" = "SP_Kit"))
View(driversFinal1)
driversFinal %>%
left_join(driver_to_E2, by = c("Item_ID" = "SP_Kit"))
driversFinal1 <- driversFinal %>%
left_join(driver_to_E2, by = c("Item_ID" = "SP_Kit"))
driversFinal1 %>%
select("RMA_ID", "Item_ID", "Item_Name", "Return_Qty", "Reason_Code", "DIM_Type", "E2", "SP_Acct_Val", "E2_Acct_Val", "SP_Price")
driversFinal1$Total_cost <- driversFinal1$Return_Qty * driversFinal1$SP_Price
View(driversFinal1)
driversFinal1 <- driversFinal %>%
left_join(driver_to_E2, by = c("Item_ID" = "SP_Kit")) %>%
select("RMA_ID", "Item_ID", "Item_Name", "Return_Qty", "Reason_Code",
"DIM_Type", "E2", "SP_Acct_Val", "E2_Acct_Val", "SP_Price")
driversFinal1$Total_cost <- driversFinal1$Return_Qty * driversFinal1$SP_Price
View(driversFinal1)
driversFinal1 <- driversFinal %>%
left_join(driver_to_E2, by = c("Item_ID" = "SP_Kit")) %>%
select("RMA_ID", "Item_ID", "Return_Qty", "DIM_Type", "E2", "SP_Acct_Val", "E2_Acct_Val", "SP_Price")
driversFinal1$Total_cost <- driversFinal1$Return_Qty * driversFinal1$SP_Price
driversFinal1$SP_Acct_Val <- as.numeric(driversFinal1$SP_Acct_Val)
driversFinal1$E2_Acct_Val <- as.numeric(driversFinal1$E2_Acct_Val)
groupedDrivers <- driversFinal1 %>%
group_by(E2, DIM_Type)
View(groupedDrivers)
driversFinal1$Total_cost <- as.numeric(driversFinal1$Total_cost)
groupedDrivers <- driversFinal1 %>%
group_by(E2, DIM_Type)
groupedDrivers1 <- summarise(groupedDrivers, "# of RMAs" = length(unique(RMA_ID)),  Qty = sum(Return_Qty))
View(groupedDrivers1)
groupedDrivers1 <- summarise(groupedDrivers, "# of RMAs" = length(unique(RMA_ID)),  Qty = sum(Return_Qty), Total_cost = sum(Total_cost))
View(groupedDrivers2)
groupedDrivers <- driversFinal1 %>%
group_by(E2, DIM_Type, E2_Acct_Val, SP_Acct_Val)
View(groupedDrivers1)
groupedDrivers1 <- summarise(groupedDrivers, "# of RMAs" = length(unique(RMA_ID)),  Qty = sum(Return_Qty), Total_cost = sum(Total_cost))
nullDrivers <- driversFinal1 %>%
filter(is.null(E2))
View(nullDrivers)
View(monthlyDrivers)
View(monthlyDrivers)
monthlyDrivers %>%
add_row("RMA12345", "SP-123-4555-9R", "DUMMY DRIVER", 5, "ELE = Electrical", "August")
monthlyDrivers %>%
add_row(RMA_ID = "RMA12345", Item_ID = "SP-123-4555-9R", Item_Name = "DUMMY DRIVER", Return_Qty = 5, Reason_Code = "ELE = Electrical", Month = "August")
monthlyDrivers %>%
rbind(c("RMA12345", "SP-123-4555-9R", "DUMMY DRIVER", 5, "ELE = Electrical", "August"))
View(nullDrivers)
monthlyDrivers <- rbind(monthlyDrivers, c("RMA12345", "SP-123-4555-9R", "DUMMY DRIVER", 5, "ELE = Electrical", "August"))
nullDrivers <- driversFinal1 %>%
filter(is.null(E2))
View(nullDrivers)
View(monthlyDrivers)
View(monthlyEngines)
View(nullDrivers)
driverIDs <- data.frame(do.call("rbind", strsplit(as.character(monthlyDrivers$Item_ID), "-", fixed = TRUE)))
driversFinal <- cbind(monthlyDrivers, driverIDs) %>%
select(c("RMA_ID", "Item_ID", "Item_Name", "Return_Qty", "Reason_Code", "X4"))
names(driversFinal) <- c("RMA_ID", "Item_ID", "Item_Name", "Return_Qty", "Reason_Code", "DIM_Type")
driversFinal1 <- driversFinal %>%
left_join(driver_to_E2, by = c("Item_ID" = "SP_Kit")) %>%
select("RMA_ID", "Item_ID", "Item_Name", "Return_Qty", "Reason_Code",
"DIM_Type", "E2", "SP_Acct_Val", "E2_Acct_Val", "SP_Price")
driversFinal1$Total_cost <- driversFinal1$Return_Qty * driversFinal1$SP_Price
driversFinal1$SP_Acct_Val <- as.numeric(driversFinal1$SP_Acct_Val)
driversFinal1$E2_Acct_Val <- as.numeric(driversFinal1$E2_Acct_Val)
driversFinal1$Total_cost <- as.numeric(driversFinal1$Total_cost)
nullDrivers <- driversFinal1 %>%
filter(is.null)
driverIDs <- data.frame(do.call("rbind", strsplit(as.character(monthlyDrivers$Item_ID), "-", fixed = TRUE)))
driversFinal <- cbind(monthlyDrivers, driverIDs) %>%
select(c("RMA_ID", "Item_ID", "Item_Name", "Return_Qty", "Reason_Code", "X4"))
names(driversFinal) <- c("RMA_ID", "Item_ID", "Item_Name", "Return_Qty", "Reason_Code", "DIM_Type")
driversFinal1 <- driversFinal %>%
left_join(driver_to_E2, by = c("Item_ID" = "SP_Kit")) %>%
select("RMA_ID", "Item_ID", "Item_Name", "Return_Qty", "Reason_Code",
"DIM_Type", "E2", "SP_Acct_Val", "E2_Acct_Val", "SP_Price")
driversFinal1$Total_cost <- driversFinal1$Return_Qty * driversFinal1$SP_Price
driversFinal1$SP_Acct_Val <- as.numeric(driversFinal1$SP_Acct_Val)
driversFinal1$E2_Acct_Val <- as.numeric(driversFinal1$E2_Acct_Val)
driversFinal1$Total_cost <- as.numeric(driversFinal1$Total_cost)
nullDrivers <- driversFinal1 %>%
filter(is.null(E2))
View(monthlyDrivers)
nullDrivers <- filter(driversFinal1, E2 = NA)
View(nullDrivers)
nullDrivers <- filter(driversFinal1, E2 == NA)
View(nullDrivers)
nullDrivers <- filter(driversFinal1, is.na(E2))
View(nullDrivers)
driver_out
driver_out <- "Code/Output/August_2021/"
c(driver_out, "nullDriver")
driver_out "nullDriver"
source('~/Projects/USAI/Code/Scripts/metricsReport.R')
monthlyDrivers <- filter(YTD_drivers, Month == "August")
View(monthlyDrivers)
monthlyDrivers <- rbind(monthlyDrivers, c("RMA12345", "SP-123-4555-9R", "DUMMY DRIVER", 5, "ELE = Electrical", "August"))
nullDrivers <- getDrivers(monthlyDrivers, "Code/Output/August_2021/drivers1.csv")
source('~/Projects/USAI/Code/Scripts/metricsReport.R')
nullDrivers <- getDrivers(monthlyDrivers, driver_out)
driverIDs <- data.frame(do.call("rbind", strsplit(as.character(monthlyDrivers$Item_ID), "-", fixed = TRUE)))
driversFinal <- cbind(monthlyDrivers, driverIDs) %>%
select(c("RMA_ID", "Item_ID", "Item_Name", "Return_Qty", "Reason_Code", "X4"))
names(driversFinal) <- c("RMA_ID", "Item_ID", "Item_Name", "Return_Qty", "Reason_Code", "DIM_Type")
driversFinal1 <- driversFinal %>%
left_join(driver_to_E2, by = c("Item_ID" = "SP_Kit")) %>%
select("RMA_ID", "Item_ID", "Item_Name", "Return_Qty", "Reason_Code",
"DIM_Type", "E2", "SP_Acct_Val", "E2_Acct_Val", "SP_Price")
driversFinal1$SP_Acct_Val <- as.numeric(driversFinal1$SP_Acct_Val)
driversFinal1$E2_Acct_Val <- as.numeric(driversFinal1$E2_Acct_Val)
driversFinal1$Total_cost <- driversFinal1$Return_Qty * driversFinal1$SP_Price
nullDrivers <- filter(driversFinal1, is.na(E2))
View(nullDrivers)
length(nullDrivers)
count(cullDrivers)
nrow(nullDrivers)
count(nullDrivers)
source('~/Projects/USAI/Code/Scripts/metricsReport.R')
source('~/Projects/USAI/Code/Scripts/metricsReport.R')
nrow(nullDrivers) > 0
source('~/Projects/USAI/Code/Scripts/metricsReport.R')
nulls <- getDrivers(monthlyDrivers, "Code/Output/August_2021/drivers1.csv")
View(nulls)
monthlyDrivers <- monthlyDrivers %>%
select()
View(monthlyDrivers)
View(monthlyDrivers)
View(monthlyEngines)
View(monthlyDrivers)
source('~/Projects/USAI/Code/Scripts/metricsReport.R')
View(monthlyDrivers)
monthlyDrivers <- filter(YTD_drivers, Month == "August")
View(monthlyDrivers)
monthlyDrivers <- filter(YTD_drivers, Month = "August")
monthlyDrivers <- filter(YTD_drivers, Month == "August")
nulls <- getDrivers(monthlyDrivers, "Code/Output/August_2021/drivers1.csv")
library(readr)
drivers1 <- read_csv("Code/Output/August_2021/drivers1.csv")
View(drivers1)
g <- ggplot(data = groupedDrivers1) + geom_col(aes(x = E2, y = Qty))
g
View(groupedDrivers)
View(groupedDrivers1)
top15Drivers <- head(groupedDrivers1, 15)
g <- ggplot(data = groupedDrivers1) + geom_col(aes(x = E2, y = Qty))
g
g
View(groupedDrivers1)
head(groupedDrivers1)
head(groupedDrivers1, 2)
head(groupedDrivers1, 15)
groupedDrivers1 <- arrange(groupedDrivers1, desc(Qty))
View(groupedDrivers1)
top15Drivers <- head(groupedDrivers1, 15)
g <- ggplot(data = groupedDrivers1) + geom_col(aes(x = E2, y = Qty))
g
g <- ggplot(data = top15Drivers) + geom_col(aes(x = E2, y = Qty))
g
top15Drivers <- arrange(top15Drivers, desc(Qty))
g <- ggplot(data = top15Drivers) + geom_col(aes(x = E2, y = Qty))
g
g <- ggplot(data = top15Drivers) + geom_col(aes(x = reorder(E2, -Qty), y = Qty))
g
source('~/Projects/USAI/Code/Scripts/metricsReport.R')
YTD_drivers <- filter(YTD_master, grepl("SP-[0-9]{3}-[0-9]{4}", Item_ID))
nullDrivers <- getDrivers(monthlyDrivers, driver_out)
driver_out <- "Code/Output/August_2021/drivers1.csv"
nullDrivers <- getDrivers(monthlyDrivers, driver_out)
library(readr)
drivers1 <- read_csv("Code/Output/August_2021/drivers1.csv")
View(drivers1)
nullDrivers
source('~/Projects/USAI/Code/Scripts/metricsReport.R')
View(monthlyDrivers)
nullDrivers <- getDrivers(monthlyDrivers, "Code/Output/August_2021/drivers1.csv")
nullDrivers
source('~/Projects/USAI/Code/Scripts/metricsReport.R')
nullDrivers <- getDrivers(monthlyDrivers, "Code/Output/August_2021/drivers1.csv")
nullDrivers
driverIDs <- data.frame(do.call("rbind", strsplit(as.character(monthlyDrivers$Item_ID), "-", fixed = TRUE)))
driversFinal <- cbind(monthlyDrivers, driverIDs) %>%
select(c("RMA_ID", "Item_ID", "Item_Name", "Return_Qty", "Reason_Code", "X4"))
names(driversFinal) <- c("RMA_ID", "Item_ID", "Item_Name", "Return_Qty", "Reason_Code", "DIM_Type")
driversFinal1 <- driversFinal %>%
left_join(driver_to_E2, by = c("Item_ID" = "SP_Kit")) %>%
select("RMA_ID", "Item_ID", "Item_Name", "Return_Qty", "Reason_Code",
"DIM_Type", "E2", "SP_Acct_Val", "E2_Acct_Val", "SP_Price")
driversFinal1$SP_Acct_Val <- as.numeric(driversFinal1$SP_Acct_Val)
driversFinal1$E2_Acct_Val <- as.numeric(driversFinal1$E2_Acct_Val)
nullDrivers <- filter(driversFinal1, is.na(E2))
if (nrow(nullDrivers) > 0)
return(nullDrivers)
driversFinal1$Total_cost <- driversFinal1$Return_Qty * driversFinal1$SP_Price
groupedDrivers <- driversFinal1 %>%
group_by(E2, DIM_Type, E2_Acct_Val, SP_Acct_Val)
groupedDrivers1 <- summarise(groupedDrivers, "# of RMAs" = length(unique(RMA_ID)),  Qty = sum(Return_Qty), Total_cost = sum(Total_cost))
groupedDrivers1 <- select(groupedDrivers1, "# of RMAs", "Qty", "E2", "DIM_Type", "E2_Acct_Val", "SP_Acct_Val", "Total_cost")
write.csv(groupedDrivers1, driver_out)
top15Drivers <- head(groupedDrivers1, 15)
top15Drivers <- arrange(top15Drivers, desc(Qty))
g <- ggplot(data = top15Drivers) + geom_col(aes(x = reorder(E2, -Qty), y = Qty))
g
driverIDs <- data.frame(do.call("rbind", strsplit(as.character(monthlyDrivers$Item_ID), "-", fixed = TRUE)))
driversFinal <- cbind(monthlyDrivers, driverIDs) %>%
select(c("RMA_ID", "Item_ID", "Item_Name", "Return_Qty", "Reason_Code", "X4"))
names(driversFinal) <- c("RMA_ID", "Item_ID", "Item_Name", "Return_Qty", "Reason_Code", "DIM_Type")
driversFinal1 <- driversFinal %>%
left_join(driver_to_E2, by = c("Item_ID" = "SP_Kit")) %>%
select("RMA_ID", "Item_ID", "Item_Name", "Return_Qty", "Reason_Code",
"DIM_Type", "E2", "SP_Acct_Val", "E2_Acct_Val", "SP_Price")
driversFinal1$SP_Acct_Val <- as.numeric(driversFinal1$SP_Acct_Val)
driversFinal1$E2_Acct_Val <- as.numeric(driversFinal1$E2_Acct_Val)
nullDrivers <- filter(driversFinal1, is.na(E2))
if (nrow(nullDrivers) > 0)
return(nullDrivers)
driversFinal1$Total_cost <- driversFinal1$Return_Qty * driversFinal1$SP_Price
groupedDrivers <- driversFinal1 %>%
group_by(E2, DIM_Type, E2_Acct_Val, SP_Acct_Val)
groupedDrivers1 <- summarise(groupedDrivers, "# of RMAs" = length(unique(RMA_ID)),  Qty = sum(Return_Qty), Total_cost = sum(Total_cost))
groupedDrivers1 <- select(groupedDrivers1, "# of RMAs", "Qty", "E2", "DIM_Type", "E2_Acct_Val", "SP_Acct_Val", "Total_cost")
write.csv(groupedDrivers1, driver_out)
top15Drivers <- head(groupedDrivers1, 15)
top15Drivers <- arrange(top15Drivers, desc(Qty))
g <- ggplot(data = top15Drivers) + geom_col(aes(x = reorder(E2, -Qty), y = Qty))
g
g <- ggplot(data = top15Drivers) + geom_col(aes(x = reorder(E2, -Qty), y = Qty))
g
top15Drivers <- arrange(top15Drivers, desc(Qty))
g <- ggplot(data = top15Drivers) + geom_col(aes(x = reorder(E2, -Qty), y = Qty))
g
g <- ggplot(data = top15Drivers) + geom_col(aes(x = reorder(E2, -Qty), y = Qty))
g
top15Drivers <- head(groupedDrivers1, 15)
View(top15Drivers)
source('~/Projects/USAI/Code/Scripts/metricsReport.R')
nullDrivers <- getDrivers(monthlyDrivers, "Code/Output/August_2021/drivers1.csv")
nullDrivers
g <- ggplot(data = top15Drivers) + geom_col(aes(x = reorder(E2, -Qty), y = Qty))
g
View(groupedDrivers1)
groupedDrivers1 <- arrange(groupedDrivers1, desc(Qty))
View(groupedDrivers1)
top15Drivers <- head(groupedDrivers1, 15)
g <- ggplot(data = top15Drivers) + geom_col(aes(x = reorder(E2, -Qty), y = Qty))
g
g <- ggplot(data = top15Drivers) + geom_col(aes(x = reorder(E2, -Qty), y = Qty), fill = E2_Acct_Val)
monthlyEngines <- filter(YTD_engines, Month == "August")
View(monthlyEngines)
rmaEngines <- monthlyEngines %>%
View(LEM_to_LED)
left_join(LEM_to_LED, )
View(LEM_to_LED)
rmaEngines <- monthlyEngines %>%
left_join(LEM_to_LED, by = c("Item_ID" = "LEM_Kit"))
View(rmaEngines)
rmaEngines$LEM <- substring(rmaEngines$Item_ID, 1, 7)
View(light_engines)
rmaEngines1 <- rmaEngines %>%
left_join(light_engine_to_partFam, by = c("LEM" = "Item.ID"))
View(rmaEngines1)
names(rmaEngines) <- c("LEM", "Item_ID", "RMA_ID", "Item_Name" , "Return_Qty",
"Reason_Code", "Month", "LED", "LEM_Acct_Val",
"LED_Acct_Val", "LEM_Price", "Product_Family")
names(rmaEngines1) <- c("LEM", "Item_ID", "RMA_ID", "Item_Name" , "Return_Qty",
"Reason_Code", "Month", "LED", "LEM_Acct_Val",
"LED_Acct_Val", "LEM_Price", "Product_Family")
View(rmaEngines1)
names(rmaEngines1) <- c("RMA_ID", "Item_ID", "Item_Name", "Return_Qty" , "Reason_Code",
"Month", "LED", "LEM_Acct_Val", "LED_Acct_Val",
"LEM_Price", "Product_Family")
groupedEngines <- group_by(rmaEngines, LED, Product_Family, LED_Acct_Val, LEM_Acct_Val, LEM_Price)
groupedEngines <- group_by(rmaEngines1, LED, Product_Family, LED_Acct_Val, LEM_Acct_Val, LEM_Price)
groupedEngines <- rmaEngines1 %>%
group_by(LED, Product_Family, LED_Acct_Val, LEM_Acct_Val, LEM_Price)
names(rmaEngines1) <- c("RMA_ID", "Item_ID", "Item_Name", "Return_Qty",
"Reason_Code", "Month", "LED", "LEM_Acct_Val",
"LED_Acct_Val", "LEM_Price", "LED ", "Product_Family")
groupedEngines <- rmaEngines1 %>%
group_by(LED, Product_Family, LED_Acct_Val, LEM_Acct_Val, LEM_Price)
groupedEngines1 <- summarize(groupedEngines, "# of RMAs" = length(unique(RMA_ID)),  Qty = sum(Return_Qty))
View(groupedEngines1)
nullEngines <- filter(rmaEngines1, is.na(LED))
View(monthlyEngines)
monthlyEngines1 <- monthlyEngines %>%
rbind(c("RMA12345", "LEM-222-22-22KS", "DUMMY ITEM", 5, "ELE = Electrical", "August"))
View(monthlyEngines1)
rmaEngines <- monthlyEngines1 %>%
left_join(LEM_to_LED, by = c("Item_ID" = "LEM_Kit"))
View(rmaEngines)
nullEngines <- filter(rmaEngines, is.na(LED))
View(nullEngines)
groupedEngines <- rmaEngines1 %>%
group_by(LED, Product_Family, LED_Acct_Val, LEM_Acct_Val, LEM_Price)
View(groupedEngines1)
groupedEngines1 <- summarize(groupedEngines, "# of RMAs" = length(unique(RMA_ID)),  Qty = sum(Return_Qty))
groupedEngines1 <- arrange(groupedEngines1, desc(Qty)) %>%
select(c("# of RMAs", "Qty", "LED", "Product_Family", "LED_Acct_Val", "LEM_Acct_Val"))
View(groupedEngines1)
groupedEngines1$Total_cost <- groupedEngines1$LEM_Acct_Val * groupedEngines1$Qty
View(groupedEngines1)
source('~/Projects/USAI/Code/Scripts/metricsReport.R')
source('~/Projects/USAI/Code/Scripts/metricsReport.R')
View(YTD_drivers)
getMonthlyData("September", "Code/Output/September_2021/Drivers.xlsx", "Code/Output/September_2021/Engines.xlsx")
View(light_engine_to_partFam)
source('~/Projects/USAI/Code/Scripts/metricsReport.R')
getMonthlyData("September", "Code/Output/September_2021/Drivers.xlsx", "Code/Output/September_2021/Engines.xlsx")
source('~/Projects/USAI/Code/Scripts/metricsReport.R')
getMonthlyData("September", "Code/Output/September_2021/Drivers.xlsx", "Code/Output/September_2021/Engines.xlsx")
source('~/Projects/USAI/Code/Scripts/metricsReport.R')
getMonthlyData("September", "Code/Output/September_2021/Drivers.xlsx", "Code/Output/September_2021/Engines.xlsx")
source('~/Projects/USAI/Code/Scripts/metricsReport.R')
getMonthlyData("September", "Code/Output/September_2021/Drivers.xlsx", "Code/Output/September_2021/Engines.xlsx")
source('~/Projects/USAI/Code/Scripts/metricsReport.R')
getMonthlyData("September", "Code/Output/September_2021/Drivers.xlsx", "Code/Output/September_2021/Engines.xlsx")
driver_out <- "Code/Output/September_2021/Drivers.xlsx"
str_c("NULL", driver_out)
sep(driver_out, ".")
str_c(driver_out, sep = ".")
str_c(driver_out, "NULL", sep = ".")
source('~/Projects/USAI/Code/Scripts/metricsReport.R')
source('~/Projects/USAI/Code/Scripts/metricsReport.R')
source('~/Projects/USAI/Code/Scripts/metricsReport.R')
getMonthlyData("September", "Code/Output/September_2021/", "Code/Output/September_2021/")
source('~/Projects/USAI/Code/Scripts/metricsReport.R')
getMonthlyData("September", "Code/Output/September_2021/", "Code/Output/September_2021/")
library(readxl)
NULL_drivers <- read_excel("Code/Output/September_2021/NULL_drivers.xlsx")
View(NULL_drivers)
source('~/Projects/USAI/Code/Scripts/metricsReport.R')
getMonthlyData("September", "Code/Output/September_2021/", "Code/Output/September_2021/")
source('~/Projects/USAI/Code/Scripts/metricsReport.R')
getMonthlyData("September", "Code/Output/September_2021/", "Code/Output/September_2021/")
source('~/Projects/USAI/Code/Scripts/metricsReport.R')
getMonthlyData("September", "Code/Output/September_2021/", "Code/Output/September_2021/")
View(light_engines)
View(YTD_drivers)
sept_drivers <- filter(YTD_drivers, Month == "September")
View(sept_drivers)
library(readr)
Drivers <- read_csv("Code/Output/September_2021/Drivers.csv")
View(Drivers)
library(readr)
augdrivers <- read_csv("Code/Output/August_2021/drivers.csv")
View(augdrivers)
sum(augdrivers$Qty)
sum(augdrivers$Total_cost)
sum(drivers$Qty)
sum(Drivers$Qty)
sum(Drivers$Total_cost)
View(Drivers)
View(augdrivers)
Drivers$Total_cost <- Drivers$Return_Qty * Drivers$SP_Acct_Val
Drivers$Total_cost <- Drivers$Qty * Drivers$SP_Acct_Val
sum(Drivers$Qty)
sum(Drivers$Total_cost)
View(YTD_engines)
library(readr)
Engines <- read_csv("Code/Output/September_2021/Engines.csv")
View(Engines)
sum(Engines$Qty)
sum(Engines$Total_cost)
source('~/Projects/USAI/Code/Scripts/metricsReport.R')
View(Drivers)
source('~/Projects/USAI/Code/Scripts/metricsReport.R')
getMonthlyData("September", "Code/Output/September_2021/")
getMonthlyData("September", "Code/Output/September_2021/", "Code/Output/September_2021/")
View(Engines)
sum(Engines$Qty)
sum(Engines$Total_cost)
View(Drivers)
sum(Drivers$Qty)
sum(Drivers$Total_cost)
Engines1 <- Engines
View(Engines1)
Engines1$Total_cost_x <- Engines1$LEM_Acct_Val * Engines1$Qty
View(Engines1)
Drivers1 <- Drivers
Drivers1$Total_cost_x <- Drivers1$Qty * Drivers1$SP_Acct_Val
View(Drivers1)
sum(Drivers1$Total_cost_x)
source("Code/Scripts/metricsReport.R")
getMonthlyData("October", "Code/Output/October_2021/drivers.csv", "Code/Output/October_2021/engines.csv")
getMonthlyData("October", "Code/Output/October_2021/", "Code/Output/October_2021/")
library(readr)
NULLdrivers <- read_csv("Code/Output/October_2021/NULLdrivers.csv")
View(NULLdrivers)
library(readr)
NULLengines <- read_csv("Code/Output/October_2021/NULLengines.csv")
View(NULLengines)
source("Code/Scripts/metricsReport.R")
getMonthlyData("October", "Code/Output/October_2021/", "Code/Output/October_2021/")
library(readr)
driversOut <- read_csv("Code/Output/October_2021/Drivers.csv")
View(driversOut)
library(readr)
EnginesOut <- read_csv("Code/Output/October_2021/Engines.csv")
View(EnginesOut)
source('~/Projects/USAI/Code/Scripts/metricsReport.R')
View(YTD_master)
View(YTD_2020)
View(YTD_master)
View(YTD_drivers)
getMonthlyData("November", "Code/Output/November_2021/Drivers.csv", "Code/Output/November_2021/Engines.csv")
library(readr)
Nulldrivers <- read_csv("Code/Output/November_2021/Drivers.csvNULLdrivers.csv")
View(Nulldrivers)
library(readr)
NullEngines <- read_csv("Code/Output/November_2021/Engines.csvNULLengines.csv")
View(NullEngines)
source('~/Projects/USAI/Code/Scripts/metricsReport.R')
getMonthlyData("November", "Code/Output/November_2021/Drivers.csv", "Code/Output/November_2021/Engines.csv")
getMonthlyData("November", "Code/Output/November_2021/", "Code/Output/November_2021/")
source('~/Projects/USAI/Code/Scripts/metricsReport.R')
View(YTD_master)
View(driver_to_E2)
View(drivers)
View(YTD_drivers)
d_out <- "Code/Output/November_2021/"
month <- "November"
monthlyDrivers <- filter(YTD_drivers, Month == month)
monthlyEngines <- filter(YTD_engines, Month == month)
View(monthlyDrivers)
View(monthlyEngines)
getDrivers(monthlyDrivers, d_out)
getLightEngines(monthlyEngines, d_out)
View(monthlyEngines)
rmaEngines <- monthlyEngines %>%
left_join(LEM_to_LED, by = c("Item_ID" = "LEM_Kit"))
View(LEM_to_LED)
LEM_to_LEDbackup <- LEM_to_LED
LEM_to_LED <- LEM_to_LED[,-6]
getLightEngines(monthlyEngines, d_out)
View(YTD_engines)
View(monthlyDrivers)
library(readr)
Drivers_out <- read_csv("Code/Output/November_2021/Drivers.csv")
View(Drivers_out)
library(readr)
Engines_out <- read_csv("Code/Output/November_2021/Engines.csv")
View(Engines_out)
sum(Engines_out$Qty)
sum(Engines_out$Total_cost)
sum(Drivers_out$Qty)
sum(Drivers_out$Total_cost)
Drivers15 <- head(Drivers_out, 15)
View(Drivers15)
Drivers15 <- Drivers15[,-1]
write.csv(Drivers15, str_c(d_out, "Driverstop15.csv"))
Engines15 <- head(Engines_out, 15)
View(LEM_to_LED)
View(Engines15)
View(Engines_out)
View(Engines15)
write.csv(Engines15, str_c(d_out, "Enginestop15.csv"))
source('~/Projects/USAI/Code/Scripts/metricsReport.R')
