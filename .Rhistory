DriversTop15 <- DriversTop15[, -1]
DriversTop15 <- head(DriversTop15, 15)
library(readr)
EnginesTop15 <- read_csv("Code/Output/December_2021/Engines.csv")
View(EnginesTop15)
EnginesTop15 <- EnginesTop15[, -1]
EnginesTop15 <- head(EnginesTop15, 15)
write.csv(EnginesTop15, "Code/Output/December_2021/EnginesTop15.csv"))
write.csv(EnginesTop15, "Code/Output/December_2021/EnginesTop15.csv")
write.csv(DriversTop15, "Code/Output/December_2021/DriversTop15.csv")
View(YTD_2020)
View(YTD_engines)
View(drivers_2020)
library(readr)
DriversT <- read_csv("Code/Output/December_2021/Drivers.csv")
View(DriversT)
sum(DriversT$Qty)
sum(DriversT$Total_cost)
library(readr)
EnginesT <- read_csv("Code/Output/December_2021/Engines.csv")
View(EnginesT)
sum(EnginesT$Qty)
sum(EnginesT$Total_cost)
No_203 <- EnginesT
filter(No_203, LED == starts_with("LED-203"))
filter(No_203, LED == contains("LED-203"))
filter(No_203, str_detect(rowname, "LED-203"))
filter(No_203, str_detect(LED, "LED-203"))
filter(No_203, !str_detect(LED, "LED-203"))
No_203 <- filter(No_203, !str_detect(LED, "LED-203"))
View(No_203)
No_203 <- filter(No_203, !str_detect(LED, "LED-213"))
View(DriversT)
No_526 <- DriversT
View(No_526)
filter(No_526, !str_detect(E2, "E2-526"))
filter(No_526, !str_detect(E2, "E2-527"))
No_526 <- filter(No_526, !str_detect(E2, "E2-526"))
No_526 <- filter(No_526, !str_detect(E2, "E2-527"))
No_526 <- head(No_526, 15)
No_203 <- head(No_203, 15)
write.csv(No_526, str_c("Code/Output/December_2021/", "Drivers_No_526.csv"))
write.csv(No_203, str_c("Code/Output/December_2021/", "Engines_No_203.csv"))
No_526 <-  No_526[, -1]
No_203 <-  No_203[, -1]
write.csv(No_526, str_c("Code/Output/December_2021/", "Drivers_No_526.csv"))
write.csv(No_203, str_c("Code/Output/December_2021/", "Engines_No_203.csv"))
source("~/Projects/USAI/Code/Scripts/metricsReport.R")
View(YTD_drivers)
source("~/Projects/USAI/Code/Scripts/metricsReport.R")
getDrivers(YTD_drivers, "Code/Output/December_2021/")
source("~/Projects/USAI/Code/Scripts/metricsReport.R")
getLightEngines(YTD_engines, "Code/Output/December_2021/")
View(LEM_to_LED)
source("~/Projects/USAI/Code/Scripts/metricsReport.R")
getLightEngines(YTD_engines, "Code/Output/December_2021/")
library(readr)
Enginesall <- read_csv("Code/Output/December_2021/Engines.csv")
View(Enginesall)
View(drivers_2020)
library(readr)
Driversall <- read_csv("Code/Output/December_2021/Driversall.csv")
View(Driversall)
Driversall <- filter(Driversall, !str_detect(E2, "E2-526"))
Driversall <- filter(Driversall, !str_detect(E2, "E2-527"))
library(readr)
Driversall <- read_csv("Code/Output/December_2021/Driversall.csv")
View(Driversall)
Driversall <- filter(Driversall, !str_detect(E2, "E2-526"))
Driversall <- filter(Driversall, !str_detect(E2, "E2-527"))
driver_output <- "Code/Output/December_2021/Drivers_all.csv"
getYTDDrivers(driver_output)
library(readr)
Drivers_all <- read_csv("Code/Output/December_2021/Drivers_all.csv")
View(Drivers_all)
Drivers_all <- filter(Drivers_all, !str_detect(E2, "E2-526"))
Drivers_all <- filter(Drivers_all, !str_detect(E2, "E2-527"))
groupedDrivers <- group_by(Drivers_all, Month)
groupedDrivers1 <- summarize(groupedDrivers, sum(Return_Qty), sum(Total_Cost))
View(groupedDrivers1)
engine_output <- "Code/Output/December_2021/Drivers_all.csv"
engine_output <- "Code/Output/December_2021/Engines_all.csv"
getYTDEngines(engine_output)
library(readr)
Engines_all <- read_csv("Code/Output/December_2021/Engines_all.csv")
View(Engines_all)
Engines_all1 <- filter(Engines_all, !str_detect(LED, "LED-203"))
View(Engines_all1)
Engines_all1 <- filter(Engines_all1, !str_detect(LED, "LED-213"))
write.csv(Engines_all, "Code/Output/December_2021/Engines_outrm_all.csv")
grouped_engines <- group_by(Engines_all1, Month)
grouped_engines1 <- summarize(grouped_engines, sum(Return_Qty), sum(Total_Cost))
View(grouped_engines1)
write.csv(grouped_engines1, "Code/Output/December_2021/Engines_outrm_all.csv")
source("~/Projects/USAI/Code/Scripts/metricsReport.R")
View(YTD_engines)
monthlyEngines <- filter(YTD_engines, Month == "December")
View(monthlyEngines)
monthlyEngines <- filter(YTD_engines, Month == "December")
source("~/Projects/USAI/Code/Scripts/metricsReport.R")
monthlyEngines <- filter(YTD_engines, Month == "December")
View(monthlyEngines)
driverIDs <- data.frame(do.call("rbind", strsplit(as.character(monthlyDrivers$Item_ID), "-", fixed = TRUE)))
driversFinal <- cbind(monthlyDrivers, driverIDs) %>%
select(c("RMA_ID", "Item_ID", "Item_Name", "Return_Qty", "Reason_Code", "X4"))
rmaEngines <- monthlyEngines %>%
left_join(LEM_to_LED, by = c("Item_ID" = "LEM_Kit"))
nullEngines <- filter(rmaEngines, is.na(LED))
if (nrow(nullEngines) > 0)
return(write.csv(nullEngines, str_c(engine_out, "NULLengines.csv")))
rmaEngines$LEM <- substring(rmaEngines$Item_ID, 1, 7)
rmaEngines1 <- rmaEngines %>%
left_join(light_engine_to_partFam, by = c("LEM" = "Item.ID"))
names(rmaEngines1) <- c("RMA_ID", "Item_ID", "Return_Qty", "Item_Name",
"Reason_Code", "Month", "LED", "LEM_Acct_Val",
"LED_Acct_Val", "LEM_Price", "LEM", "Product_Family")
View(rmaEngines1)
rmaEngines1$Return_Qty <- as.numeric(rmaEngines1$Return_Qty)
rmaEngines1$LEM_Acct_Val <- as.numeric(rmaEngines1$LEM_Acct_Val)
rmaEngines1$LED_Acct_Val <- as.numeric(rmaEngines1$LED_Acct_Val)
rmaEngines1$LEM_Price <- as.numeric(rmaEngines1$LEM_Price)
groupedEngines <- rmaEngines1 %>%
group_by(LED, Product_Family, LED_Acct_Val, LEM_Acct_Val, LEM_Price)
View(groupedEngines)
groupedEngines1 <- summarize(groupedEngines, "# of RMAs" = length(unique(RMA_ID)),  Qty = sum(Return_Qty))
groupedEngines1 <- arrange(groupedEngines1, desc(Qty)) %>%
select(c("# of RMAs", "Qty", "LED", "Product_Family", "LED_Acct_Val", "LEM_Acct_Val"))
View(groupedEngines1)
groupedEngines1$Total_cost <- groupedEngines1$LEM_Acct_Val * groupedEngines1$Qty
write.csv(groupedEngines1, str_c("Code/Output/December_2021/", "Engines.csv"))
write.csv(head(groupedEngines1, 15), str_c("Code/Output/December_2021/", "Engines_top15.csv"))
filter(groupedEngines1, !str_detect(LED, "LED-203"))
groupedEngines2 <- filter(groupedEngines1, !str_detect(LED, "LED-203"))
groupedEngines2 <- filter(groupedEngines1, !str_detect(LED, "LED-213"))
write.csv(head(groupedEngines2, 15), str_c("Code/Output/December_2021/", "Engines_top15_noOutliers.csv"))
groupedEngines2 <- filter(groupedEngines, !str_detect(LED, "LED-213"))
write.csv(head(groupedEngines2, 15), str_c("Code/Output/December_2021/", "Engines_top15_noOutliers.csv"))
groupedEngines2 <- filter(groupedEngines1, !str_detect(LED, "LED-203"))
View(groupedEngines2)
groupedEngines2 <- filter(groupedEngines2, !str_detect(LED, "LED-213"))
write.csv(head(groupedEngines2, 15), str_c("Code/Output/December_2021/", "Engines_top15_noOutliers.csv"))
source("~/Projects/USAI/Code/Scripts/metricsReport.R")
source("~/Projects/USAI/Code/Scripts/metricsReport.R")
source("~/Projects/USAI/Code/Scripts/metricsReport.R")
library(readxl)
YTD_2022 <- read_excel("Code/Failure_rate/2022/YTD_2022.xlsx")
View(YTD_2022)
source("~/Projects/USAI/Code/Scripts/metricsReport.R")
View(driver_to_E2)
View(YTD_2022)
View(YTD_drivers)
View(YTD_engines)
View(YTD_drivers)
View(YTD_2022)
getMonthlyData("January", "Code/Output/January_2022/", "Code/Output/January_2022/")
library(readr)
NULLdrivers <- read_csv("Code/Output/January_2022/NULLdrivers.csv")
View(NULLdrivers)
select(NULLdrivers, Item_ID)
getMonthlyData("January", "Code/Output/January_2022/", "Code/Output/January_2022/")
source("~/Projects/USAI/Code/Scripts/metricsReport.R")
getMonthlyData("January", "Code/Output/January_2022/", "Code/Output/January_2022/")
library(readr)
NULLdrivers <- read_csv("Code/Output/January_2022/NULLdrivers.csv")
View(NULLdrivers)
select(NULLdrivers, Item_ID)
source("~/Projects/USAI/Code/Scripts/metricsReport.R")
getMonthlyData("January", "Code/Output/January_2022/", "Code/Output/January_2022/")
getMonthlyData("January", "Code/Output/January_2022/", "Code/Output/January_2022/")
month <- "January"
monthlyDrivers <- filter(YTD_drivers, Month == month)
driverIDs <- data.frame(do.call("rbind", strsplit(as.character(monthlyDrivers$Item_ID), "-", fixed = TRUE)))
driversFinal <- cbind(monthlyDrivers, driverIDs) %>%
select(c("RMA_ID", "Item_ID", "Item_Name", "Return_Qty", "Reason_Code", "X4"))
names(driversFinal) <- c("RMA_ID", "Item_ID", "Item_Name", "Return_Qty", "Reason_Code", "DIM_Type")
driversFinal1 <- driversFinal %>%
left_join(driver_to_E2, by = c("Item_ID" = "SP_Kit")) %>%
select("RMA_ID", "Item_ID", "Item_Name", "Return_Qty", "Reason_Code",
"DIM_Type", "E2", "SP_Acct_Val", "E2_Acct_Val", "SP_Price")
class(driversFinal1$SP_Acct_Val)
class(driversFinal1$E2_Acct_Val)
class(driversFinal1$Return_Qty)
source("~/Projects/USAI/Code/Scripts/metricsReport.R")
getMonthlyData("January", "Code/Output/January_2022/", "Code/Output/January_2022/")
library(readr)
Drivers <- read_csv("Code/Output/January_2022/Drivers.csv")
View(Drivers)
library(readr)
Engines <- read_csv("Code/Output/January_2022/Engines.csv")
View(Engines)
View(driver_to_E2)
class(driver_to_E2$SP_Kit)
class(driver_to_E2$E2)
class(driver_to_E2$SP_Acct_Val)
class(driver_to_E2$E2_Acct_Val)
class(driver_to_E2$SP_Price)
View(monthlyDrivers)
driverIDs <- data.frame(do.call("rbind", strsplit(as.character(monthlyDrivers$Item_ID), "-", fixed = TRUE)))
driversFinal <- cbind(monthlyDrivers, driverIDs) %>%
select(c("RMA_ID", "Item_ID", "Item_Name", "Return_Qty", "Reason_Code", "X4"))
names(driversFinal) <- c("RMA_ID", "Item_ID", "Item_Name", "Return_Qty", "Reason_Code", "DIM_Type")
driversFinal1 <- driversFinal %>%
left_join(driver_to_E2, by = c("Item_ID" = "SP_Kit")) %>%
select("RMA_ID", "Item_ID", "Item_Name", "Return_Qty", "Reason_Code",
"DIM_Type", "E2", "SP_Acct_Val", "E2_Acct_Val", "SP_Price")
View(driversFinal1)
View(driversFinal)
source("~/Projects/USAI/Code/Scripts/metricsReport.R")
getMonthlyData("January", "Code/Output/January_2022/", "Code/Output/January_2022/")
library(readr)
Drivers <- read_csv("Code/Output/January_2022/Drivers.csv")
View(Drivers)
library(readr)
Engines <- read_csv("Code/Output/January_2022/Engines.csv")
View(Engines)
Drivers
Drivers15 <- head(Drivers, 15)
View(Drivers15)
write.csv(Drivers15, "Code/Output/January_2022/Driverstop15.csv")
Engines15 <- head(Engines, 15)
View(Engines15)
write.csv(Engines15, "Code/Output/January_2022/Enginestop15.csv")
Drivers[Drivers$E2 == "E2-526"]
Drivers[,Drivers$E2 == "E2-526"]
Drivers[,Drivers$E2 = "E2-526"]
Drivers[, E2 = "E2-526"]
Drivers$E2[, E2 = "E2-526"]
Drivers$E2[E2 = "E2-526"]
Drivers[E2 == "E2-526"]
Drivers[, E2 == "E2-526"]
Drivers$E2
Drivers[1, 1]
Drivers[1, 2]
Drivers[1, 3]
Drivers[1, 4]
Drivers[E2 == "E2-526",]
Drivers[Drivers$E2 == "E2-526",]
Drivers[-Drivers$E2 == "E2-526",]
Drivers[-(Drivers$E2 == "E2-526"),]
Drivers[Drivers$E2 != "E2-526",]
DriversNoOutliers <- Drivers
DriversNoOutliers <- Drivers[Drivers$E2 != "E2-526", ]
DriversNoOutliers <- Drivers[Drivers$E2 != "E2-527", ]
DriversNoOutliers
View(DriversNoOutliers)
DriversNoOutliers <- Drivers[DriversNoOutliers$E2 != "E2-527", ]
DriversNoOutliers <- Drivers[DriversNoOutliers$E2 != "E2-526", ]
DriversNoOutliers <- Drivers[DriversNoOutliers$E2 != "E2-527", ]
DriversNoOutliers <- DriversNoOutliers[DriversNoOutliers$E2 != "E2-527", ]
DriversNoOutliers <- DriversNoOutliers[DriversNoOutliers$E2 != "E2-526", ]
EnginesNoOutliers <- Engines
EnginesNoOutliers[grep("LED-203*", EnginesNoOutliers$LED), ]
EnginesNoOutliers[grep("LED-203", EnginesNoOutliers$LED), ]
EnginesNoOutliers <- EnginesNoOutliers[grep("LED-203", EnginesNoOutliers$LED), ]
EnginesNoOutliers[grep("LED-203", EnginesNoOutliers$LED), ]
View(EnginesNoOutliers)
EnginesNoOutliers <- Engines
EnginesNoOutliers[-grep("LED-203", EnginesNoOutliers$LED), ]
EnginesNoOutliers <- EnginesNoOutliers[-grep("LED-203", EnginesNoOutliers$LED), ]
EnginesNoOutliers <- EnginesNoOutliers[-grep("LED-213", EnginesNoOutliers$LED), ]
EnginesNoOutliers[-grep("LED-203", EnginesNoOutliers$LED), ]
EnginesNoOutliers[-grep("LED-213", EnginesNoOutliers$LED), ]
EnginesNoOutliers[-grep("LED-203", EnginesNoOutliers$LED), ]
DriversNoOutliers15 <- head(DriversNoOutliers, 15)
EnginesNoOutliers15 <- head(DriversNoOutliers, 15)
write.csv(DriversNoOutliers15, "Code/Output/January_2022/DriversNoOutliers15.csv")
write.csv(EnginesNoOutliers15, "Code/Output/January_2022/EnginesNoOutliers15.csv")
totalsDrivers <- data.frame(Qty = sum(Drivers$Qty), Cost = sum(Drivers$Total_cost))
View(totalsDrivers)
totalsEngines <- data.frame(Qty = sum(Engines$Qty), Cost = sum(Engines$Total_cost))
View(totalsEngines)
totalsDriversNoOutliers <- data.frame(Qty = sum(DriversNoOutliers$Qty), Cost = sum(DriversNoOutliers$Total_cost))
View(totalsDriversNoOutliers)
View(totalsDrivers)
View(totalsDriversNoOutliers)
View(totalsEngines)
totalsEnginesNoOutliers <- data.frame(Qty = sum(EnginesNoOutliers$Qty), Cost = sum(EnginesNoOutliers$Total_cost))
View(totalsDrivers)
View(totalsDriversNoOutliers)
View(totalsEngines)
View(totalsEnginesNoOutliers)
rbind(data.frame("Engines No Outliers"), totalsEnginesNoOutliers)
cbind(data.frame("Engines No Outliers"), totalsEnginesNoOutliers)
cbind(data.frame(Type = "Engines No Outliers"), totalsEnginesNoOutliers)
totalsEnginesNoOutliers <- cbind(data.frame(Type = "Engines No Outliers"), totalsEnginesNoOutliers)
totalsDriversNoOutliers <- cbind(data.frame(Type = "Drivers No Outliers"), totalsDriversNoOutliers)
totalsDrivers <- cbind(data.frame(Type = "Engines"), totalsDrivers)
totalsEngines <- cbind(data.frame(Type = "Engines"), totalsEngines)
totalsDrivers$Type <- "Drivers"
rbind(TotalsDrivers, totalsEngines, totalsDriversNoOutliers, totalsEnginesNoOutliers)
rbind(totalsDrivers, totalsEngines, totalsDriversNoOutliers, totalsEnginesNoOutliers)
allTotals <- rbind(totalsDrivers, totalsEngines, totalsDriversNoOutliers, totalsEnginesNoOutliers)
View(allTotals)
write.csv(allTotals, "Code/Output/January_2022/totals.csv")
View(Engines15)
View(EnginesNoOutliers)
View(EnginesNoOutliers15)
View(EnginesNoOutliers)
EnginesNoOutliers15 <- head(EnginesNoOutliers, 15)
write.csv(EnginesNoOutliers15, "Code/Output/January_2022/EnginesNoOutliers15.csv")
library(readr)
EnginesNoOutliers15 <- read_csv("Code/Output/January_2022/EnginesNoOutliers15.csv")
View(EnginesNoOutliers15)
library(readxl)
January_2022 <- read_excel("Code/Failure_rate/2022/January_2022.xlsx")
View(January_2022)
library(readxl)
February_2022 <- read_excel("Code/Failure_rate/2022/February_2022.xlsx")
View(February_2022)
names(January_2022)
names(February_2022)
feb <- select(February_2022, c(names(January_2022)))
library(dplyr)
feb <- select(February_2022, c(names(January_2022)))
February_2022$Month <- "February"
feb <- select(February_2022, c(names(January_2022)))
View(feb)
source("~/Projects/USAI/Code/Scripts/metricsReport.R")
getMonthlyData("February", "Code/Output/February_2022/", "Code/Output/February_2022/")
library(readxl)
YTD_2022 <- read_excel("Code/Failure_rate/2022/YTD_2022.xlsx")
View(YTD_2022)
YTD_2022b <- rbind(YTD_2022, feb)
View(YTD_2022b)
write.xlsx(YTD_2022b, "Code/Failure_rate/2022/YTD_2022.xlsx")
library(readxl)
YTD_2022 <- read_excel("Code/Failure_rate/2022/YTD_2022.xlsx")
View(YTD_2022)
getMonthlyData("February", "Code/Output/February_2022/", "Code/Output/February_2022/")
driverIDs <- data.frame(do.call("rbind", strsplit(as.character(monthlyDrivers$Item_ID), "-", fixed = TRUE)))
View(driverIDs)
driversFinal <- cbind(monthlyDrivers, driverIDs) %>%
select(c("RMA_ID", "Item_ID", "Item_Name", "Return_Qty", "Reason_Code", "X4"))
View(driversFinal)
source("~/Projects/USAI/Code/Scripts/metricsReport.R")
getMonthlyData("February", "Code/Output/February_2022/", "Code/Output/February_2022/")
source("~/Projects/USAI/Code/Scripts/metricsReport.R")
getMonthlyData("February", "Code/Output/February_2022/", "Code/Output/February_2022/")
source("~/Projects/USAI/Code/Scripts/metricsReport.R")
getMonthlyData("February", "Code/Output/February_2022/", "Code/Output/February_2022/")
source("~/Projects/USAI/Code/Scripts/metricsReport.R")
monthlyDrivers <- filter(YTD_drivers, Month == "February")
monthlyEngines <- filter(YTD_engines, Month == "February")
driverIDs <- data.frame(do.call("rbind", strsplit(as.character(monthlyDrivers$Item_ID), "-", fixed = TRUE)))
driversFinal <- cbind(monthlyDrivers, driverIDs) %>%
select(c("RMA_ID", "Item_ID", "Item_Name", "Return_Qty", "Reason_Code", "X4"))
names(driversFinal) <- c("RMA_ID", "Item_ID", "Return_Qty", "Item_Name", "Reason_Code", "DIM_Type")
driversFinal1 <- driversFinal %>%
left_join(driver_to_E2, by = c("Item_ID" = "SP_Kit")) %>%
select("RMA_ID", "Item_ID", "Item_Name", "Return_Qty", "Reason_Code",
"DIM_Type", "E2", "SP_Acct_Val", "E2_Acct_Val", "SP_Price")
driversFinal1$SP_Acct_Val <- as.numeric(driversFinal1$SP_Acct_Val)
driversFinal1$E2_Acct_Val <- as.numeric(driversFinal1$E2_Acct_Val)
driversFinal1$Return_Qty <- as.numeric(driversFinal1$Return_Qty)
View(driversFinal1)
driversFinal1NoOutliers <- filter(driversFinal1, E2 != "E2-526")
driversFinal1NoOutliers <- filter(driversFinal1, E2 != "E2-526" | E2 != "E2-527")
driversFinal1NoOutliers <- filter(driversFinal1, E2 != "E2-526" & E2 != "E2-527")
View(driversFinal1NoOutliers)
driversFinal1$Total_cost <- driversFinal1$Return_Qty * driversFinal1$SP_Acct_Val
groupedDrivers <- driversFinal1 %>%
group_by(E2, DIM_Type, E2_Acct_Val, SP_Acct_Val)
View(groupedDrivers)
groupedDrivers1 <- summarise(groupedDrivers, "# of RMAs" = length(unique(RMA_ID)),  Qty = sum(Return_Qty), Total_cost = sum(Total_cost))
groupedDrivers1 <- select(groupedDrivers1, "# of RMAs", "Qty", "E2", "DIM_Type", "E2_Acct_Val", "SP_Acct_Val", "Total_cost")
groupedDrivers1 <- arrange(groupedDrivers1, desc(Qty))
View(groupedDrivers1)
groupedDriversNoOutliers <- filter(groupedDrivers1, E2 != "E2-526" & E2 != "E2-527")
View(groupedDriversNoOutliers)
groupedDriversNoOutliers <- head(filter(groupedDrivers1, E2 != "E2-526" & E2 != "E2-527"), 15)
source("~/Projects/USAI/Code/Scripts/metricsReport.R")
getMonthlyData("February", "Code/Output/February_2022/", "Code/Output/February_2022/")
rmaEngines <- monthlyEngines %>%
left_join(LEM_to_LED, by = c("Item_ID" = "LEM_Kit"))
nullEngines <- filter(rmaEngines, is.na(LED))
if (nrow(nullEngines) > 0)
return(write.csv(nullEngines, str_c(engine_out, "NULLengines.csv")))
rmaEngines$LEM <- substring(rmaEngines$Item_ID, 1, 7)
rmaEngines1 <- rmaEngines %>%
left_join(light_engine_to_partFam, by = c("LEM" = "Item.ID"))
names(rmaEngines1) <- c("RMA_ID", "Item_ID", "Return_Qty", "Item_Name",
"Reason_Code", "Month", "LED", "LEM_Acct_Val",
"LED_Acct_Val", "LEM_Price", "LEM", "Product_Family")
rmaEngines1$Return_Qty <- as.numeric(rmaEngines1$Return_Qty)
rmaEngines1$LEM_Acct_Val <- as.numeric(rmaEngines1$LEM_Acct_Val)
rmaEngines1$LED_Acct_Val <- as.numeric(rmaEngines1$LED_Acct_Val)
rmaEngines1$LEM_Price <- as.numeric(rmaEngines1$LEM_Price)
groupedEngines <- rmaEngines1 %>%
group_by(LED, Product_Family, LED_Acct_Val, LEM_Acct_Val, LEM_Price)
groupedEngines1 <- summarize(groupedEngines, "# of RMAs" = length(unique(RMA_ID)),  Qty = sum(Return_Qty))
groupedEngines1 <- arrange(groupedEngines1, desc(Qty)) %>%
select(c("# of RMAs", "Qty", "LED", "Product_Family", "LED_Acct_Val", "LEM_Acct_Val"))
groupedEngines1$Total_cost <- groupedEngines1$LEM_Acct_Val * groupedEngines1$Qty
View(groupedEngines1)
filter(groupedEngines1, str_detect(LED, "LED-203"))
filter(groupedEngines1, str_detect(LED, "LED-213"))
filter(groupedEngines1, !str_detect(LED, "LED-213"))
filter(groupedEngines1, !str_detect(LED, "LED-213") & !str_detect("LED-203"))
filter(groupedEngines1, !str_detect(LED, "LED-213") && !str_detect("LED-203"))
filter(groupedEngines1, !str_detect(LED, "LED-213") !str_detect("LED-203"))
filter(groupedEngines1, !str_detect(LED, "LED-213"))
groupedEnginesNoOutliers <- filter(groupedEngines1, !str_detect(LED, "LED-213"))
groupedEnginesNoOutliers <- filter(groupedEnginesNoOutliers, !str_detect(LED, "LED-203"))
View(groupedEnginesNoOutliers)
source("~/Projects/USAI/Code/Scripts/metricsReport.R")
source("~/Projects/USAI/Code/Scripts/metricsReport.R")
getMonthlyData("February", "Code/Output/February_2022/", "Code/Output/February_2022/")
source("~/Projects/USAI/Code/Scripts/metricsReport.R")
getMonthlyData("February", "Code/Output/February_2022/", "Code/Output/February_2022/")
getMonthlyData("February", "Code/Output/February_2022/", "Code/Output/February_2022/")
getMonthlyData("February", "Code/Output/February_2022/", "Code/Output/February_2022/")
source("~/Projects/USAI/Code/Scripts/metricsReport.R")
getMonthlyData("February", "Code/Output/February_2022/", "Code/Output/February_2022/")
getMonthlyData("February", "Code/Output/February_2022/", "Code/Output/February_2022/")
library(AppliedPredictiveModeling)
data(segmentationOriginal)
library(caret)
inTrain <- createDataPartition(y=segmentationOriginal, p=0.75, list=FALSE)
View(segmentationOriginal)
?createDataPartition
createDataPartition?
;
?createDataPartition
inTrain <- createDataPartition(y=segmentationOriginal$Case, p=0.75, list=FALSE)
View(inTrain)
training <- segmentationOriginal[inTrain]
training <- segmentationOriginal[inTrain]
dim(training)
source("~/Projects/USAI/Code/Scripts/metricsReport.R")
source("~/Projects/USAI/Code/Scripts/metricsReport.R")
getMonthlyData("March", "Code/Output/March_2022/", "Code/Output/March_2022/")
library(readr)
NULLdrivers <- read_csv("Code/Output/March_2022/NULLdrivers.csv")
View(NULLdrivers)
library(readr)
NULLengines <- read_csv("Code/Output/March_2022/NULLengines.csv")
View(NULLengines)
View(NULLdrivers)
NULLdrivers <- NULLdrivers[, 3]
NULLengines <- NULLengines[, 3]
View(nullEngines)
View(driversFinal)
View(monthlyEngines)
View(monthlyDrivers)
View(monthlyDrivers)
View(monthlyEngines)
View(monthlyDrivers)
View(monthlyEngines)
View(monthlyDrivers)
View(YTD_drivers)
View(YTD_engines)
View(YTD_master)
View(YTD_master)
source("~/Projects/USAI/Code/Scripts/metricsReport.R")
source("~/Projects/USAI/Code/Scripts/metricsReport.R")
View(YTD_master)
View(YTD_drivers)
View(YTD_engines)
getMonthlyData("March", "Code/Output/March_2022/", "Code/Output/March_2022/")
month = "March"
monthlyDrivers <- filter(YTD_drivers, Month == month)
monthlyEngines <- filter(YTD_engines, Month == month)
View(monthlyDrivers)
View(monthlyEngines)
driverIDs <- data.frame(do.call("rbind", strsplit(as.character(monthlyDrivers$Item_ID), "-", fixed = TRUE)))
View(driverIDs)
driversFinal <- cbind(monthlyDrivers, driverIDs) %>%
select(c("RMA_ID", "Item_ID", "Item_Name", "Return_Qty", "Reason_Code", "X4"))
View(driversFinal)
names(driversFinal) <- c("RMA_ID", "Item_ID", "Item_Name", "Return_Qty", "Reason_Code", "DIM_Type")
View(driversFinal)
driversFinal1 <- driversFinal %>%
left_join(driver_to_E2, by = c("Item_ID" = "SP_Kit")) %>%
select("RMA_ID", "Item_ID", "Item_Name", "Return_Qty", "Reason_Code",
"DIM_Type", "E2", "SP_Acct_Val", "E2_Acct_Val", "SP_Price")
View(driversFinal1)
driversFinal1$SP_Acct_Val <- as.numeric(driversFinal1$SP_Acct_Val)
driversFinal1$E2_Acct_Val <- as.numeric(driversFinal1$E2_Acct_Val)
driversFinal1$Return_Qty <- as.numeric(driversFinal1$Return_Qty)
nullDrivers <- filter(driversFinal1, is.na(E2))
View(nullDrivers)
View(driversFinal1)
View(driversFinal1)
View(nullDrivers)
rmaEngines <- monthlyEngines %>%
left_join(LEM_to_LED, by = c("Item_ID" = "LEM_Kit"))
View(rmaEngines)
nullEngines <- filter(rmaEngines, is.na(LED))
View(nullEngines)
if (nrow(nullEngines) > 0)
return(write.csv(nullEngines, str_c(engine_out, "NULLengines.csv")))
nullEngines <- filter(rmaEngines, is.na(LED))
View(nullEngines)
View(nullEngines)
source("~/Projects/USAI/Code/Scripts/metricsReport.R")
source("~/Projects/USAI/Code/Scripts/metricsReport.R")
getMonthlyData("March", "Code/Output/March_2022/", "Code/Output/March_2022/")
library(readr)
NULLdrivers <- read_csv("Code/Output/March_2022/NULLdrivers.csv")
View(NULLdrivers)
library(readr)
NULLengines <- read_csv("Code/Output/March_2022/NULLengines.csv")
View(NULLengines)
NULLengines <- NULLengines$Item_ID
NULLdrivers <- NULLdrivers$Item_ID
NULLdrivers <- data.frame(NULLdrivers)
NULLengines <- data.frame(NULLengines)
View(NULLdrivers)
View(NULLengines)
source("~/Projects/USAI/Code/Scripts/metricsReport.R")
getMonthlyData("March", "Code/Output/March_2022/")
getMonthlyData("March", "Code/Output/March_2022/", "Code/Output/March_2022/" )
=======
source("Code/Scripts/rmaPrep.R")
rma <- read.xlsx("Reports/April_2022/Print_and_Detail_Reports/ISSUES REPORTS (4_15_2022).xlsx")
rmaDetails <- read.xlsx("Reports/April_2022/Print_and_Detail_Reports/ISSUES REPORTS (4_15_2022)Details.xlsx")
dim(rma)
dim(rmaDetails)
rma_edit(rma, rmaDetails, "Reports/April_2022/Week_End_4_15_2022/output.xlsx")
q()
